{% extends "base/base.html.j2" %}
{% block title %}
    {{ texts.recipe }}
{% endblock %}

 {% block links %}
    {{ super() }}
    {{ turbo() }}
    <!-- include summernote css/js-->
    <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js"></script>
{% endblock %}

{% block script %}
    {% include 'javascript/stimulus.js.html' %}
    {% include 'javascript/enable_select2_controller.js.html' %}
{% endblock %}

{% block content %}

<details open class="form-control mb-5">
<summary> Upravit recept </summary>
<form action="{{ url_for('EditRecipeView:post', recipe_id=recipe.id) }}" class="form" method="post" accept-charset="utf-8">
    {{ form.csrf_token }}

    <div class="w-100 mt-2 mb-2 row">
        <div class="col-2 pt-2 pl-3"> {{ form.name.label }}</div>
        <div class="col"> {{ render_field(form.name, has_label=False) }} </div>
    </div>

    <div class="w-100 mt-2 mb-2 row">
        <div class="col-2 pt-2 pl-3"> {{ form.category.label }}</div>
        <div class="col"> {{ render_field(form.category, has_label=False) }} </div>
    </div>

    <div class="w-100 mt-2 mb-2 row">
        <div class="col-2 pt-2 pl-3"> {{ form.portion_count.label }}</div>
        <div class="col"> {{ render_field(form.portion_count, has_label=False) }} </div>
    </div>

    <input type="submit" value="{{ texts.recipe_edit }}" class="btn btn-warning">
</form>
</details>

<details open class="form-control mb-5" data-controller="enable-select2">
<summary> Upravit suroviny </summary>
<div>
    {% include "recipes/edit/_add_ingredient_form.html.j2" %}
</div>

<table id="ingredients" class="table">
    <tr>
        <th>{{ texts.title }}</th>
        <th>Množství (na {{ recipe.portion_count }} porcí) </th>
    </tr>

    {% for ingredient in recipe.ingredients: %}
        {% include "recipes/edit/_edit_ingredient.html.j2" %}
    {% endfor %}
</table>
</details>


<details class="form-control mb-5">
<summary> Upravit návod </summary>
<div>
    <form action="{{ url_for('EditRecipeView:post_description', recipe_id=recipe.id) }}" class="form" method="post" accept-charset="utf-8">
        <textarea id="summernote" name="description" class='form-control'>
            {% if recipe.description %}{{ recipe.description }}{% endif %}
        </textarea>
        <button type="submit" class="btn btn-warning">Uložit návod</button>
    </form>
</div>
</details>

<a class="btn btn-secondary ml-2" href="{{ url_for('RecipesView:show', id=recipe.id) }}">{{ texts.edit_finish }} {{ icon("edit") }}</a>

{% endblock %}

{% block scripts_after %}
<script type="text/javascript">
    $(document).ready(function() {$('#summernote').summernote();});
</script>
{% endblock %}