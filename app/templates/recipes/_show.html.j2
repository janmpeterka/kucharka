<div class="mb-2" id="recipe-info">
    <div> 
        <h2> {{ recipe.name }} </h2> 
    </div>
    
   {#  <div>
        <span class="font-italic"> Kategorie: {{ recipe.category.name }} </span><br>

        {% if not print %}
            {% if recipe.is_shared and not recipe.is_current_user_author %}
                <span class="font-italic font-weight-light float-right"> (vytvořil*a {{ recipe.author.name }}) </span>
            {% elif recipe.is_shared %}
                <span class="font-italic font-weight-light float-right"> {{ icon("shared") }} </span>
            {% endif %}
        {% endif %}

    </div>
    <div>
        {% if not print %}
            <span class="float-right">
            {% for label in recipe.labels %}
                {{ icon(label.icon_name) }}
           {% endfor %}
            </span>
        {% endif %}
    </div>
</div> #}


<table id="ingredients" class="table">
    <tr>
        <th>{{ texts.title }}</th>
        <th>Množství (na {{recipe.portion_count}} porcí)</th>
        {# <th>{{ texts.amount_simple }}</th> #}
        <th></th>
    </tr>

    {% for ingredient in recipe.ingredients: %}
    {% set ingredient_amount = ingredient.amount * recipe.portion_count %}
        <tr>
            {% if not print %}
                
            <td>{{ link_to(ingredient) }}
                {% if ingredient.is_public %} {{ icon("public", class="text-secondary") }} {% endif %}
            </td>
            {% else %}
                <td>{{ ingredient.name }}</td>
            {% endif %}

            <td>
            {% if ingredient.is_measured %}
                {% if ingredient.measurement.thousand_fold and ingredient_amount % 1000 != ingredient_amount %}
                    {{ formatted_amount(ingredient_amount/1000) }} {{ ingredient.measurement.thousand_fold }}
                {% else %}
                    {{ formatted_amount(ingredient_amount) }} {{ ingredient.measurement.name }}
                {% endif %}

                {% if ingredient.alternative_measurement %}
                    {% set ns = namespace(title="přibližně\n") %}      
                    {% for conversion in ingredient.alternative_measurements %}
                        {% set ns.title = ns.title + formatted_amount(ingredient_amount/conversion.amount_from * conversion.amount_to) | string + " " + conversion.to_measurement.name %}

                        {% set ns.title = ns.title + "\n" %}
                    {% endfor %}
                    <abbr title="{{ ns.title }}">
                         {{ icon("info-circle", class="ml-1") }}
                    </abbr>   
                {% endif %}

            {% endif %}
            </td>

            <td><em>{{ ingredient.comment|default("", True) }}</em></td>
        </tr>
    {% endfor %}
</table>

{# <hr> #}

{% if recipe.description %}
    {% include "recipes/_description.html.j2" %}
{% endif %}