{% extends "base/base.html.j2" %}
{% block title %} strávníci {% endblock %}

{% block content %}
    <h1> strávníci na {{ link_to(event) }}</h1>
    <ul>
    {% for attendee in event.attendees %}
        <turbo-frame id="attendee-{{attendee.id}}">
        
        {% if edit_id == attendee.id %}
            <li>
                <form action="{{ url_for("AttendeeView:update", attendee_id=attendee.id) }}" class="row row-cols-lg-auto g-3 align-items-center" method="POST" target="_top">
                    {{ form.csrf_token }}
                    <div class="col-4">
                        {{ render_floating_field(edit_form.name) }}
                    </div>
                    <div class="col-4">
                        {{ render_field(edit_form.portion_size_ratio) }}
                    </div>
                    <div class="col-4">
                        {{ render_field(edit_form.update) }}
                        <a href="{{ url_for("AttendeeView:show", event_id=event.id) }}"> zrušit </a>
                    </div>
                </form>
            </li>
        {% else %}
        <li>
            <strong> {{ attendee.name }} </strong> jí na {{ (attendee.portion_size_ratio * 100) | round | int }} %
            | <a href="{{ url_for("AttendeeView:show", event_id=event.id, edit_id=attendee.id) }}"> upravit </a>
        </li>
        {% endif %}

        </turbo-frame>
    {% endfor %}
    </ul>

    a dalších {{ event.people_count - event.attendees | length }} lidí, o kterých nic nevíme..

    {% if (event.people_count - event.attendees | length) > 0 %}

    <hr>

    <h3 class="mt-4">přidej strávníka</h3>
    <form action="{{ url_for("AttendeeView:post", event_id=event.id) }}" class="row row-cols-lg-auto g-3 align-items-center" method="POST">
        {{ form.csrf_token }}
        <div class="col-4">
            {{ render_floating_field(form.name) }}
        </div>
        <div class="col-4">
            {{ render_field(form.portion_size_ratio) }}
        </div>
        <div class="col-4">
            {{ render_field(form.submit) }}
        </div>
    </form>
    {% endif %}
{% endblock %}