{% from "macros/turbo.html.j2" import button_to %}

{% extends "base/base.html.j2" %}
{% block title %} Denní přehled {% endblock %}

{% block links %}
    {{ super() }}
    {{ turbo() }}
{% endblock %}

{% block script %}
    {{ stimulus("select2") }}
{% endblock %}

{% block content %}

<div>
    <div class="text-center">

        {% if daily_plan.has_previous %}
        <span class="float-start" style="margin-left: 10rem">
            <a href="{{ url_for('DailyPlansView:previous', daily_plan_id=daily_plan.id) }}">
            {{ human_format_date(daily_plan.previous.date) }}
            </a>
        </span>
        {% endif %}

        <span style="font-size: 2rem">
            {{ human_format_date(daily_plan.date, with_relative=False) }}
        </span>

        {% if daily_plan.has_next %}
        <span class="float-end" style="margin-left: 10rem">
            <a href="{{ url_for('DailyPlansView:next', daily_plan_id=daily_plan.id) }}">
            {{ human_format_date(daily_plan.next.date) }}
            </a>
        </span>
        {% endif %}

    <h2>{{ link_to(daily_plan.event) }}</h2>
    
    </div>

    <div class="row">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th style="width: 40%">{{ texts.title }}</th>
                    <th style="width: 20%">Typ jídla</th>
                    <th style="width: 20%">Počet porcí</th>
                    <th style="width: 5%"></th>
                    <th style="width: 10%"></th>
                </tr>
            </thead>
            <tbody id="daily_recipes">
            {% for daily_recipe in daily_recipes %}
                {% include "daily_plans/_recipe_row.html.j2"%}
            {% endfor %}
            </tbody>
        </table>
    </div>

    {% if daily_plan.can_current_user_edit %}

    <div class="row float-end mt-5" data-controller="enable-select2">
        <form class="form" action="{{ url_for('DailyPlansEditView:add_recipe', daily_plan_id=daily_plan.id) }}" method="post">
            <div class="form-group form-inline">
                <select name="recipe_id" id="recipe_select" class="form-control" data-enable-select2-target="select">
                    {% include "daily_plans/_add_recipe_form_options.html.j2" %}
                </select>
            </div>

            <input type="submit" class="form-control btn btn-primary" value="Přidat recept">
        </form>
    </div>

    <div class="row mt-5">
        {{ button_to(action=url_for('DailyPlansEditView:add_shopping', daily_plan_id=daily_plan.id), class="btn btn-secondary", value="Přidat nákup <i class='fas fa-shopping-basket'></i>") }}
    </div>

    {% endif %}
</div>

{% endblock %}